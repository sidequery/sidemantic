# BSL fixture based on the official BSL flights example
# Tests more complex features: nested access, multiple measures, joins

profile: example_db

carriers:
  table: carriers
  description: "Airline carrier information"

  dimensions:
    code: _.code
    name: _.name
    nickname: _.nickname

  measures:
    carrier_count:
      expr: _.count()
      description: "Total number of carriers"

flights:
  table: flights
  description: "Flight data with origin/destination and metrics"

  dimensions:
    origin: _.origin
    destination: _.destination
    dep_time:
      expr: _.dep_time
      is_time_dimension: true
      smallest_time_grain: "TIME_GRAIN_DAY"
    distance: _.distance
    carrier: _.carrier

  measures:
    flight_count:
      expr: _.count()
      description: "Total number of flights"
    total_distance:
      expr: _.distance.sum()
      description: "Total distance flown"
    avg_distance:
      expr: _.distance.mean()
      description: "Average flight distance"
    min_distance:
      expr: _.distance.min()
      description: "Minimum flight distance"
    max_distance:
      expr: _.distance.max()
      description: "Maximum flight distance"

  joins:
    carriers:
      model: carriers
      type: one
      left_on: carrier
      right_on: code
