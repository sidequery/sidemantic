# Source: dbt-labs/metricflow (Apache 2.0)
# https://github.com/dbt-labs/metricflow/blob/main/metricflow-semantics/metricflow_semantics/test_helpers/semantic_manifest_yamls/scd_manifest/scd_listings.yaml
# Tests: SCD Type II validity_params with is_start/is_end, natural entity type,
#   primary_entity shorthand, categorical dimensions on SCD table

semantic_models:
  - name: listings
    description: SCD Type II table of listings history
    model: ref('dim_listings')
    dimensions:
      - name: window_start
        type: time
        expr: active_from
        type_params:
          time_granularity: day
          validity_params:
            is_start: true
      - name: window_end
        type: time
        expr: active_to
        type_params:
          time_granularity: day
          validity_params:
            is_end: true
      - name: country
        type: categorical
      - name: is_lux
        type: categorical
      - name: capacity
        type: categorical
    primary_entity: listing
    entities:
      - name: listing
        type: natural
        expr: listing_id
      - name: user
        type: foreign
        expr: user_id
