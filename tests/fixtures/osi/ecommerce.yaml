semantic_model:
  - name: ecommerce_analytics
    description: E-commerce sales and customer analytics

    datasets:
      - name: orders
        source: sales.public.orders
        primary_key: [order_id]
        description: Customer orders
        fields:
          - name: order_id
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: order_id
            description: Order identifier
          - name: customer_id
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: customer_id
            description: Customer identifier
          - name: order_date
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: order_date
            dimension:
              is_time: true
            description: Order date
          - name: status
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: status
            description: Order status
          - name: amount
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: amount
            description: Order amount

      - name: customers
        source: sales.public.customers
        primary_key: [customer_id]
        description: Customer information
        fields:
          - name: customer_id
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: customer_id
            description: Customer identifier
          - name: name
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: name
            description: Customer name
          - name: email
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: email
            description: Customer email
          - name: created_at
            expression:
              dialects:
                - dialect: ANSI_SQL
                  expression: created_at
            dimension:
              is_time: true
            description: Account creation date

    relationships:
      - name: orders_to_customers
        from: orders
        to: customers
        from_columns: [customer_id]
        to_columns: [customer_id]

    metrics:
      - name: total_revenue
        expression:
          dialects:
            - dialect: ANSI_SQL
              expression: SUM(orders.amount)
        description: Total revenue from all orders
      - name: order_count
        expression:
          dialects:
            - dialect: ANSI_SQL
              expression: COUNT(orders.order_id)
        description: Total number of orders
      - name: avg_order_value
        expression:
          dialects:
            - dialect: ANSI_SQL
              expression: AVG(orders.amount)
        description: Average order value
      - name: customer_count
        expression:
          dialects:
            - dialect: ANSI_SQL
              expression: COUNT(DISTINCT orders.customer_id)
        description: Number of unique customers
